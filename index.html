<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jonah Ortiz — Interview Assistant</title>
  <style>
    /* Reset and box sizing */
    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f0f0f0;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Header fixed on top */
    header.contact-info {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 100px;
      background-color: #121212;
      color: white;
      padding: 1.5em 2em;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    header.contact-info h1 {
      font-size: 3em;
      margin: 0 0 0.2em 0;
      font-weight: bold;
    }

    header.contact-info .tagline {
      font-size: 1.2em;
      margin: 0 0 0.5em 0;
      font-weight: 500;
      color: #bbb;
    }

    header.contact-info p {
      margin: 0;
      font-size: 1em;
    }

    header.contact-info a {
      color: #bbdefb;
      text-decoration: none;
      margin-right: 0.5em;
    }

    header.contact-info a:hover {
      text-decoration: underline;
    }

    /* Chatbot sidebar below header */
    aside#chat-container {
      position: fixed;
      top: 100px; /* height of header */
      left: 0;
      bottom: 0;
      width: 350px;
      background: #ffffff;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
      z-index: 1000;
    }

    #chat-container header {
      background: #1e1e2f;
      color: white;
      padding: 1em;
      text-align: center;
      flex-shrink: 0;
    }

    #chat {
      flex: 1;
      padding: 1em;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    form {
      display: flex;
      gap: 0.5em;
      padding: 1em;
      flex-shrink: 0;
      border-top: 1px solid #ddd;
    }

    input[type="text"] {
      flex: 1;
      padding: 0.75em;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    button {
      background: #1e1e2f;
      border: none;
      color: white;
      padding: 0 1.5em;
      font-size: 1em;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background: #333353;
    }

    .message {
      margin: 0.5em 0;
      max-width: 75%;
      padding: 0.75em 1em;
      border-radius: 15px;
      line-height: 1.3;
      word-wrap: break-word;
    }

    .user {
      background: #d0e6ff;
      color: #004a99;
      align-self: flex-end;
      border-bottom-right-radius: 2px;
    }

    .bot {
      background: #e5e5e5;
      color: #333;
      align-self: flex-start;
      border-bottom-left-radius: 2px;
    }

    .bot.typing {
      font-style: italic;
      opacity: 0.7;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { opacity: 0.5; }
      50% { opacity: 1; }
      100% { opacity: 0.5; }
    }

    /* Main content area - pushed right and down below header */
    main {
      margin-top: 100px; /* header height */
      margin-left: 350px; /* sidebar width */
      padding: 2em;
      background: white;
      height: auto;
      overflow: visible;
    }

    section h2 {
      margin-top: 0;
    }

    /* Resume iframe fixed height */
    iframe.resume-viewer {
      width: 100%;
      height: 80vh;  /* 80% of viewport height */
      border: 1px solid #ccc;
      overflow: hidden;
    }

    footer {
      text-align: center;
      padding: 1em;
      font-size: 0.8em;
      color: #888;
    }

    /* Responsive: stack chat below header on small screens */
    @media (max-width: 768px) {
      aside#chat-container {
        position: fixed;
        top: 160px;
        left: 0;
        width: 100%;
        height: calc(100vh - 160px);
        border-right: none;
        border-top: 1px solid #ddd;
      }

      main {
        margin-left: 0;
        margin-top: 160px;
        padding-bottom: 300px;
      }

      header.contact-info {
        height: auto;
        padding-bottom: 1em;
      }
    }
  </style>
</head>
<body>

<header class="contact-info">
  <h1>Jonah Ortiz</h1>
  <p class="tagline">Business Intelligence and Data Analytics Professional</p>
  <p>
    <a href="mailto:jonahg.ortiz@gmail.com">jonahg.ortiz@gmail.com</a> |
    <a href="tel:+19493702188">(949) 370-2188</a> |
    San Diego, CA |
    <a href="https://www.linkedin.com/in/jonahgortiz" target="_blank" rel="noopener">LinkedIn Profile</a> |
    <a href="https://jonahortiz.github.io/JONAHORTIZ_CV_07.2025.pdf" download>Download Resume</a>
  </p>
</header>

<aside id="chat-container">
  <header>
    <h2>Interview Assistant</h2>
    <p style="font-size: 0.9em; margin: 0;">Ask me about Jonah Ortiz</p>
  </header>
  <div id="chat" aria-live="polite" aria-atomic="false"></div>
  <form id="chat-form">
    <input type="text" id="user-input" autocomplete="off" placeholder="Type your question..." required />
    <button type="submit">Send</button>
  </form>
</aside>

<main>
  <section>
    <h2>About Jonah</h2>
    <p>Jonah Ortiz is a Business Intelligence Analyst with 10 years of experience in data analytics, working with companies like HP, Seer Interactive, and Havas Edge. He specializes in subscription analytics, agile sprints, and building self-serve data tools in Databricks and ThoughtSpot.</p>
  </section>

  <section>
    <h2>Resume</h2>
    <iframe
      class="resume-viewer"
      src="https://jonahortiz.github.io/JONAHORTIZ_CV_07.2025.pdf"
      title="Jonah Ortiz Resume"
      loading="lazy"
    ></iframe>
    <p>If the resume above does not load, you can <a href="https://jonahortiz.github.io/JONAHORTIZ_CV_07.2025.pdf" download>download it here</a>.</p>
  </section>

  <footer>
    Powered by OpenAI &amp; n8n · Hosted on GitHub Pages
  </footer>
</main>

<script>
  const chat = document.getElementById('chat');
  const form = document.getElementById('chat-form');
  const input = document.getElementById('user-input');

  // Generate or retrieve sessionId
  let sessionId = sessionStorage.getItem('sessionId');
  if (!sessionId) {
    sessionId = crypto.randomUUID();
    sessionStorage.setItem('sessionId', sessionId);
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const userMessage = input.value.trim();
    if (!userMessage) return;
    input.value = '';

    appendMessage(userMessage, 'user');

    // Show typing indicator
    const typingIndicator = appendMessage('Bot is typing...', 'bot', true);
    typingIndicator.classList.add('typing');

    try {
      const response = await fetch('https://jonahgortiz.app.n8n.cloud/webhook/interview-bot', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          message: userMessage,
          sessionId: sessionId
        })
      });

      if (!response.ok) throw new Error(`Network error: ${response.status}`);

      const data = await response.json();
      const botReply = data.reply || data.message || "Sorry, I didn't get a response.";

      typingIndicator.textContent = botReply;
      typingIndicator.classList.remove('typing');
    } catch (error) {
      console.error('Chatbot error:', error);
      typingIndicator.textContent = 'Error: Unable to reach the chatbot. Please try again later.';
      typingIndicator.classList.remove('typing');
    }
  });

  function appendMessage(text, sender, returnNode = false) {
    const div = document.createElement('div');
    div.classList.add('message', sender);
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    return returnNode ? div : undefined;
  }
</script>

</body>
</html>
